from validate import validate_input, validate_output

import unittest
import voluptuous
import json

class TestStringMethods(unittest.TestCase):

    def test_input_minimal_example(self):
        minimal_example = {'location': {'name': 'Hannut'}}
        validate_input(minimal_example)

    def test_input_full_example(self):
        full_example = {
            'location': {
                'name': 'Hannut',
                'coordinates': {
                    'lat': 50.67215,
                    'lon': 5.07776
                }
            },
            'attendees': [
                {'name': 'Gilles', 'preferences': 'afghani,african,bbq'},
                {'name': 'Vincent'},
                {'name': 'Edwin', 'preferences': ''},
            ],
            'max_distance': 500,
            'price_range': "1,2",
            'locale': 'en_BE',
            'open_now': True,
        }
        validate_input(full_example)

    def test_input_missing_location(self):
        missing_location_example = {'price_range': "1,2"}
        with self.assertRaises(voluptuous.error.MultipleInvalid):
            validate_input(missing_location_example)

    def test_output_result_hannut(self):
        # result from {'location': {'name': 'Hannut'}}
        hannut_output = """{"code":0,"messages":[],"number_of_results":4,"restaurants":[{"alias":"le-p-tit-gaby-hannut","categories":[{"alias":"french","title":"French"}],"coordinates":{"latitude":50.67254,"longitude":5.07681},"display_phone":"019 63 37 72","distance":1704.8286313349513,"id":"b11ZN2G6zbeiK5-mEIN89g","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/-kfbq7H7iEOSUEBfpgvpNQ/o.jpg","is_closed":false,"location":{"address1":"rue de Tirlemont 5","address2":null,"address3":null,"city":"Hannut","country":"BE","display_address":["rue de Tirlemont 5","4280 Hannut"],"state":"WLG","zip_code":"4280"},"name":"Le P'tit Gaby","phone":"+3219633772","rating":5.0,"review_count":1,"transactions":[],"url":"https://en.yelp.be/biz/le-p-tit-gaby-hannut?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"la-gondola-hannut","categories":[{"alias":"italian","title":"Italian"}],"coordinates":{"latitude":50.67256,"longitude":5.07849},"display_phone":"019 51 38 54","distance":1719.9679148232044,"id":"iwSX5vtsEHyjV8jUmjJczg","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/uv9LIBcCMjMoggdCYihObw/o.jpg","is_closed":false,"location":{"address1":"Grand Place 16","address2":null,"address3":null,"city":"Hannut","country":"BE","display_address":["Grand Place 16","4280 Hannut"],"state":"WLG","zip_code":"4280"},"name":"La Gondola","phone":"+3219513854","price":"\u20ac\u20ac\u20ac","rating":4.0,"review_count":1,"transactions":[],"url":"https://en.yelp.be/biz/la-gondola-hannut?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"la-hannutoise-hannut","categories":[{"alias":"brasseries","title":"Brasserie"}],"coordinates":{"latitude":50.67228,"longitude":5.07841},"display_phone":"019 51 12 03","distance":1688.3473604167452,"id":"3VHsKpKmv4zls14aqWOGWA","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/0ej9dMJV0lPSyPldz1vBZw/o.jpg","is_closed":false,"location":{"address1":"Grand Place 19","address2":null,"address3":null,"city":"Hannut","country":"BE","display_address":["Grand Place 19","4280 Hannut"],"state":"WLG","zip_code":"4280"},"name":"La Hannutoise","phone":"+3219511203","price":"\u20ac\u20ac","rating":3.5,"review_count":2,"transactions":[],"url":"https://en.yelp.be/biz/la-hannutoise-hannut?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"jardin-d-orient-le-hannut","categories":[{"alias":"restaurants","title":"Restaurants"}],"coordinates":{"latitude":50.67004,"longitude":5.08138},"display_phone":"019 51 68 88","distance":1491.5168246403766,"id":"HpwIjHfHI9rwwnQ6sukrlg","image_url":"","is_closed":false,"location":{"address1":"Rue Albert 1er 45","address2":null,"address3":null,"city":"Hannut","country":"BE","display_address":["Rue Albert 1er 45","4280 Hannut"],"state":"WLG","zip_code":"4280"},"name":"Jardin D'Orient, le","phone":"+3219516888","price":"\u20ac\u20ac","rating":4.0,"review_count":1,"transactions":[],"url":"https://en.yelp.be/biz/jardin-d-orient-le-hannut?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"}]}"""
        validate_output(json.loads(hannut_output))

    def test_output_result_ixelles(self):
        # result from
        # {
        #     'location': {
        #         'name': 'Flagey Building 29, rue du Belvédère 1050 Brussels Belgium',
        #     },
        #     'attendees': [
        #         {'name': 'Gilles', 'preferences': 'afghani,african,bbq'},
        #         {'name': 'Vincent', 'preferences': 'asianfusion,burgers,brasseries'},
        #         {'name': 'Edwin', 'preferences': ''}
        #     ],
        #     'max_distance': 1000,
        #     'price_range': "1,2",
        #     'locale': 'en_BE',
        #     'open_now': True
        # }
        ixelles_output = """{"code":0,"messages":[],"number_of_results":10,"restaurants":[{"alias":"green-mango-bruxelles","categories":[{"alias":"juicebars","title":"Juice Bar & Smoothies"},{"alias":"burgers","title":"Burgers"},{"alias":"salad","title":"Salad"}],"coordinates":{"latitude":50.8229842,"longitude":4.3674551},"display_phone":"02 649 90 13","distance":580.8056380372997,"id":"HN0Pk-k7b7_xgVQxI40z-g","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/4pFq3nK_c969M068PEWZFQ/o.jpg","is_closed":false,"location":{"address1":"Chauss\u00e9e de Vleurgat 142","address2":"Vleurgatsesteenweg 142","address3":"","city":"Brussels","country":"BE","display_address":["Chauss\u00e9e de Vleurgat 142","Vleurgatsesteenweg 142","1000 Brussels"],"state":"BRU","zip_code":"1000"},"name":"Green Mango","phone":"+3226499013","price":"\u20ac\u20ac","rating":4.5,"review_count":68,"transactions":[],"url":"https://en.yelp.be/biz/green-mango-bruxelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"l-amour-fou-ixelles","categories":[{"alias":"burgers","title":"Burgers"},{"alias":"breakfast_brunch","title":"Breakfast & Brunch"},{"alias":"cocktailbars","title":"Cocktail Bars"}],"coordinates":{"latitude":50.83247,"longitude":4.3666},"display_phone":"02 325 73 53","distance":792.0182270258167,"id":"ZP2jyzHhCtlNiTxhGgQ-JA","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/kv94_BzhHu1585qsjVK4Cw/o.jpg","is_closed":false,"location":{"address1":"Chauss\u00e9e d'Ixelles 185","address2":"Elsensesteenweg 185","address3":"","city":"Ixelles","country":"BE","display_address":["Chauss\u00e9e d'Ixelles 185","Elsensesteenweg 185","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"L'Amour Fou","phone":"+3223257353","price":"\u20ac\u20ac","rating":4.0,"review_count":202,"transactions":[],"url":"https://en.yelp.be/biz/l-amour-fou-ixelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"black-sheep-bruxelles","categories":[{"alias":"gastropubs","title":"Gastro Pubs"}],"coordinates":{"latitude":50.826769812249,"longitude":4.37473550248763},"display_phone":"02 644 38 03","distance":104.86278910638997,"id":"6VDfOiQhCyTHyneBHBn4VQ","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/u10v0rRUKyr4mL26kOj6tA/o.jpg","is_closed":false,"location":{"address1":"Chausee De Boondael 8","address2":"","address3":"","city":"Brussels","country":"BE","display_address":["Chausee De Boondael 8","1050 Brussels"],"state":"BRU","zip_code":"1050"},"name":"Black Sheep","phone":"+3226443803","price":"\u20ac\u20ac","rating":4.5,"review_count":30,"transactions":[],"url":"https://en.yelp.be/biz/black-sheep-bruxelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"umamido-ixelles","categories":[{"alias":"ramen","title":"Ramen"}],"coordinates":{"latitude":50.827659,"longitude":4.371073},"display_phone":"02 640 40 57","distance":185.31032141640574,"id":"XqL7CzG5WZ_X9bVHLE952w","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/m1K6RC0iHefgMRyLxuD1jw/o.jpg","is_closed":false,"location":{"address1":"Chauss\u00e9e de Vleurgat 1","address2":"Vleurgatse Steenweg 1","address3":"","city":"Ixelles","country":"BE","display_address":["Chauss\u00e9e de Vleurgat 1","Vleurgatse Steenweg 1","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"Umamido","phone":"+3226404057","price":"\u20ac\u20ac","rating":4.0,"review_count":189,"transactions":[],"url":"https://en.yelp.be/biz/umamido-ixelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"\u00e9mile-ixelles","categories":[{"alias":"bistros","title":"Bistros"}],"coordinates":{"latitude":50.82306,"longitude":4.38151},"display_phone":"02 642 96 29","distance":708.462219179028,"id":"3i2S77L6f_EaztROsZxxKA","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/wlBoSStEazSXciKIs2vEOA/o.jpg","is_closed":false,"location":{"address1":"Avenue Emile de Beco 22","address2":"Emile de Becolaan 22","address3":"","city":"Ixelles","country":"BE","display_address":["Avenue Emile de Beco 22","Emile de Becolaan 22","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"\u00c9mile","phone":"+3226429629","price":"\u20ac\u20ac","rating":4.0,"review_count":117,"transactions":[],"url":"https://en.yelp.be/biz/%C3%A9mile-ixelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"kif-kif-caf\u00e9-ixelles-2","categories":[{"alias":"mediterranean","title":"Mediterranean"},{"alias":"moroccan","title":"Moroccan"},{"alias":"tea","title":"Tea Rooms"}],"coordinates":{"latitude":50.8252,"longitude":4.37071},"display_phone":"02 644 18 10","distance":246.66378671938244,"id":"tfx5aO_QFuzbjMD8Y4lqgw","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/iyZpn-NGvDEotCHl3fr1PQ/o.jpg","is_closed":false,"location":{"address1":"Square de Biarritz 1","address2":"Biarritzsquare 1","address3":"","city":"Ixelles","country":"BE","display_address":["Square de Biarritz 1","Biarritzsquare 1","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"Kif Kif Caf\u00e9","phone":"+3226441810","price":"\u20ac\u20ac","rating":4.0,"review_count":52,"transactions":[],"url":"https://en.yelp.be/biz/kif-kif-caf%C3%A9-ixelles-2?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"contrebande-ixelles","categories":[{"alias":"beerbar","title":"Beer Bars"},{"alias":"belgian","title":"Belgian"}],"coordinates":{"latitude":50.833309,"longitude":4.366153},"display_phone":"02 512 24 66","distance":886.580926515846,"id":"t0wxdxA3m6H3CMqXpZ0G3g","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/cqAjhEFXi_eTxnqu0cRUAA/o.jpg","is_closed":false,"location":{"address1":"Place Fernand Coq 6","address2":"Fernand Cocqplein 6","address3":null,"city":"Ixelles","country":"BE","display_address":["Place Fernand Coq 6","Fernand Cocqplein 6","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"Contrebande","phone":"+3225122466","price":"\u20ac\u20ac","rating":4.5,"review_count":10,"transactions":[],"url":"https://en.yelp.be/biz/contrebande-ixelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"\u00f4-banh-mi-etterbeek","categories":[{"alias":"vietnamese","title":"Vietnamese"}],"coordinates":{"latitude":50.8303088888626,"longitude":4.38120938837528},"display_phone":"02 649 59 27","distance":687.5698542969545,"id":"1rRDdiGuYPI6WBdVtD4o4w","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/h4C-BhTa91IBiUEpeNZR_Q/o.jpg","is_closed":false,"location":{"address1":"Rue Philippe Baucq 140","address2":"Philippe Baucqstraat 140","address3":null,"city":"Etterbeek","country":"BE","display_address":["Rue Philippe Baucq 140","Philippe Baucqstraat 140","1040 Etterbeek"],"state":"BRU","zip_code":"1040"},"name":"\u00d4 Banh Mi","phone":"+3226495927","price":"\u20ac","rating":4.5,"review_count":9,"transactions":[],"url":"https://en.yelp.be/biz/%C3%B4-banh-mi-etterbeek?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"o-regua-ixelles","categories":[{"alias":"portuguese","title":"Portuguese"}],"coordinates":{"latitude":50.82715,"longitude":4.37472},"display_phone":"","distance":110.34778019740159,"id":"yzoAqmMQviYHhv_5YWP-Lg","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/2RXcqh2lgyE56EhD0Cja8A/o.jpg","is_closed":false,"location":{"address1":"Chauss\u00e9e de Boondael 26","address2":"Boondaelsesteenweg 26","address3":"","city":"Ixelles","country":"BE","display_address":["Chauss\u00e9e de Boondael 26","Boondaelsesteenweg 26","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"O'Regua","phone":"","price":"\u20ac","rating":4.5,"review_count":5,"transactions":[],"url":"https://en.yelp.be/biz/o-regua-ixelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"},{"alias":"le-bar-\u00e0-vins-ixelles","categories":[{"alias":"wine_bars","title":"Wine Bars"},{"alias":"cafes","title":"Cafes"}],"coordinates":{"latitude":50.8271408,"longitude":4.3706198},"display_phone":"02 852 80 64","distance":190.91198775618258,"id":"I9ykwBhY3HnOBcGtix2CPQ","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/bS1w45NmSBRtKrfc6NzpSg/o.jpg","is_closed":false,"location":{"address1":"Chauss\u00e9e de Vleurgat 27","address2":"Vleurgatsesteenweg 27","address3":"","city":"Ixelles","country":"BE","display_address":["Chauss\u00e9e de Vleurgat 27","Vleurgatsesteenweg 27","1050 Ixelles"],"state":"BRU","zip_code":"1050"},"name":"Le Bar \u00e0 Vins","phone":"+3228528064","price":"\u20ac\u20ac","rating":4.0,"review_count":28,"transactions":[],"url":"https://en.yelp.be/biz/le-bar-%C3%A0-vins-ixelles?adjust_creative=xmeWw8fVCKzlbrCGsTztkQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=xmeWw8fVCKzlbrCGsTztkQ"}]}"""
        validate_output(json.loads(ixelles_output))
